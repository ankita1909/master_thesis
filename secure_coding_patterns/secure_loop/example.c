#include <stdio.h>
#include <string.h>

#include "my_header.h"

unsigned char key[16] = {0x2b, 0x7e, 0x15, 0x16, 0x28, 0xae, 0xd2, 0xa6, 0xab, 0xf7, 0x15, 0x88, 0x09, 0xcf, 0x4f, 0x3c};   
unsigned char inp[16]  = {0xae,0x2d,0x8a,0x57,0x1e,0x03,0xac,0x9c,0x9e,0xb7,0x6f,0xac,0x45,0xaf,0x8e,0x51};
unsigned char out[16] ={0xf5, 0xd3, 0xd5, 0x85, 0x03, 0xb9, 0x69, 0x9d, 0xe7, 0x85, 0x89, 0x5a, 0x96, 0xfd, 0xba, 0xaf};


int main(void) {
  unsigned char buffer[16];
  memcpy(buffer, inp, sizeof(buffer));

  AES aes = aes_new(buffer, key);
  aes_encrypt(&aes);

  printf("AES encryption\n0x");
  for (unsigned int index = 0; index < sizeof(buffer); index++)
  {
    printf("%x ", buffer[index]);
    if (buffer[index] != out[index])
    {
      printf(" Fehler (%x <-> %x) ", buffer[index], out[index]);
    }
  }

  printf("\n");
  return 0;
}
